--***그룹함수 (다중행 함수, 집계 함수)
--**avg:평균 max:최대 min:최소 sum:합 count:행갯수
SELECT 
    ROUND(AVG(salary)) 평균값, MAX(salary) 최댓값, MIN(salary) 최솟값, 
    SUM(salary) 합계, COUNT(salary) 카운트
FROM employees
WHERE job_id LIKE '%REP%';
--전체 직원들의 수:107
SELECT 
    COUNT(*)
FROM employees;
--부서에 속한 직원들의 수:106, 전체 직원들의 수 :107 -->한명은 null = 사장 : 그룹함수에서는 null값을 제외함.
SELECT 
    COUNT(department_id) 
FROM employees;
--80번 부서의 직원들의 수
SELECT 
    COUNT(*)
FROM employees
WHERE department_id=80;
--중복되지 않은 부서의 갯수('distinct')
SELECT 
    COUNT(DISTINCT department_id) 
FROM employees;
--null 값을 제외한 모든 직원들의 커미션 평균
SELECT 
    AVG(commission_pct)
FROM employees; 

--**group by 절 : 그룹 별로 값을 구함.
SELECT 
    department_id 부서번호, ROUND(AVG(salary)) 평균급여
FROM employees
GROUP BY department_id
ORDER BY 부서번호;

-- 여기부터 복습,,,,,,,,,,,,,,
--예제1
select department_id 부서명, count(department_id) 사원수, max(salary) 최고급여,
        min(salary) 최소급여, sum(salary) 급여합계, round(avg(salary)) 평균급여
from employees
group by department_id
order by 급여합계 desc;
--예제2
select department_id 부서번호, job_id 직업, sum(salary) 월급합계, count(*) 직원수
from employees
group by job_id, department_id
order by 부서번호;
--예제3
select round(avg(max(salary)))부서별최고월급평균, round(avg(min(salary))) 부서별최저월급평균
from employees
group by department_id;


--**HAVING : 그룹함수(group by ~ ) 내의 조건절 (where 조건 x)
select department_id 부서번호, count(*) 사원수
from employees
group by department_id
having count(*) > 5; --사원수 5명이 넘는 부서
--예제1
select job_id 직종, sum(salary) 월급여합계
from employees
where job_id <> 'AC_MGR'
group by job_id
having avg(salary) > 10000
order by 월급여합계 desc;
--예제2
select department_id 부서번호, round(avg(salary)) 평균급여 
from employees
where department_id not like 40
group by department_id
having avg(salary)<=7000;
--예제3
select job_id 직업번호, sum(salary) 급여합계
from employees
where job_id not like '%REP%'
group by job_id
having sum(salary) >= 13000
order by 급여합계 desc;


















